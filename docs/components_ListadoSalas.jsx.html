<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/ListadoSalas.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/ListadoSalas.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Componente funcional que muestra una tabla con el listado de salas.
 * Incluye el nombre del museo asociado y opciones para editar o eliminar cada sala.
 * @module ListadoSalas
 */
import { useState, useEffect } from "react";
import Table from "@mui/material/Table";
import TableBody from "@mui/material/TableBody";
import TableCell from "@mui/material/TableCell";
import TableContainer from "@mui/material/TableContainer";
import TableHead from "@mui/material/TableHead";
import TableRow from "@mui/material/TableRow";
import Paper from "@mui/material/Paper";
import Typography from "@mui/material/Typography";
import Chip from "@mui/material/Chip";

import BotonBorrar from "./BotonBorrar";
import BotonEditar from "./BotonEditar";

/**
 * Componente principal para mostrar el listado de salas.
 * Utiliza estados para gestionar los datos, errores y renderizado de la tabla.
 * @returns {JSX.Element} Renderizado de la tabla de salas y controles asociados.
 */
function ListadoSalas() {
  /**
   * Datos de las salas obtenidos desde la API, incluyendo el nombre del museo asociado.
   * @type {Array&lt;Object>}
   */
  const [datos, setDatos] = useState([]);
  /**
   * Mensaje de error en caso de fallo al obtener los datos.
   * @type {string|null}
   */
  const [error, setError] = useState(null);

  /**
   * Hook de efecto para obtener los datos de las salas y museos al cargar el componente.
   * Llama a la función asíncrona fetchSalas una sola vez al montar el componente.
   */
  useEffect(() => {
    /**
     * Función asíncrona para obtener los datos de las salas y asociar el nombre del museo.
     * @async
     * @function
     * @returns {Promise&lt;void>}
     */
    async function fetchSalas() {
      try {
        let responseSalas = await fetch("http://localhost:3000/api/rooms/");

        if (responseSalas.ok) {
          let datosSalas = await responseSalas.json();

          let responseMuseos = await fetch("http://localhost:3000/api/museums/");

          if (responseMuseos.ok) {
            let datosMuseos = await responseMuseos.json();

            /* Crear mapa museum_id -> nombre */
            const mapaMuseos = {};
            datosMuseos.datos.forEach((museo) => {
              mapaMuseos[museo.museum_id] = museo.name;
            });

            /* Salas con nombre del museo */
            const salasConMuseo = datosSalas.datos.map((sala) => ({
              ...sala,
              museum_name: mapaMuseos[sala.museum_id] || "Desconocido",
            }));

            setDatos(salasConMuseo);
            setError(null);
          } else {
            setError("Respuesta errónea del servidor (museos).");
            setDatos([]);
          }
        } else {
          setError("Respuesta errónea del servidor (salas).");
          setDatos([]);
        }
      } catch (e) {
        setError("No se pudo conectar al servidor: " + e.toString());
        setDatos([]);
      }
    }

    fetchSalas();
  }, []);

  // Renderizado de mensaje de error si ocurre algún problema al obtener los datos
  if (error != null) {
    return (
      &lt;Typography variant="h5" align="center" sx={{ mt: 3 }}>
        {error}
      &lt;/Typography>
    );
  }

  // Renderizado principal de la tabla de salas y controles
  return (
    &lt;>
      &lt;Typography variant="h4" align="center" color="primary" sx={{ my: 3 }}>
        Listado de salas
      &lt;/Typography>

      &lt;TableContainer component={Paper}>
        &lt;Table stickyHeader aria-label="tabla salas">
          &lt;TableHead>
            &lt;TableRow>
              &lt;TableCell>Nombre&lt;/TableCell>
              &lt;TableCell align="right">Capacidad&lt;/TableCell>
              &lt;TableCell align="right">Área (m²)&lt;/TableCell>
              &lt;TableCell align="center">Climatizada&lt;/TableCell>
              &lt;TableCell align="center">Fecha apertura&lt;/TableCell>
              &lt;TableCell align="center">Museo&lt;/TableCell>
              &lt;TableCell align="center">Borrar&lt;/TableCell>
              &lt;TableCell align="center">Editar&lt;/TableCell>
            &lt;/TableRow>
          &lt;/TableHead>

          &lt;TableBody>
            {datos.map((row) => (
              &lt;TableRow key={row.room_id}>
                &lt;TableCell>{row.name}&lt;/TableCell>
                &lt;TableCell align="right">{row.capacity}&lt;/TableCell>
                &lt;TableCell align="right">{row.area}&lt;/TableCell>
                &lt;TableCell align="center">
                  &lt;Chip label={row.is_climatized ? "Sí" : "No"} color={row.is_climatized ? "success" : "default"} size="small" />
                &lt;/TableCell>
                &lt;TableCell align="center">{row.opening_date}&lt;/TableCell>

                {/* Nombre del museo */}
                &lt;TableCell align="center">{row.museum_name}&lt;/TableCell>
                
                {/* BOTÓN BORRAR */}
                &lt;TableCell align="center">
                  &lt;BotonBorrar 
                  ruta="/rooms/" 
                  id={row.room_id} />
                &lt;/TableCell>

                {/* BOTÓN EDITAR */}
                &lt;TableCell align="center">
                  &lt;BotonEditar 
                  ruta="/rooms/editar/"
                  id={row.room_id} />
                &lt;/TableCell>
              &lt;/TableRow>
            ))}
          &lt;/TableBody>
        &lt;/Table>
      &lt;/TableContainer>
    &lt;/>
  );
}

export default ListadoSalas;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AltaMuseo.html">AltaMuseo</a></li><li><a href="module-AltaSala.html">AltaSala</a></li><li><a href="module-BotonBorrar.html">BotonBorrar</a></li><li><a href="module-BotonEditar.html">BotonEditar</a></li><li><a href="module-BusquedaMuseos.html">BusquedaMuseos</a></li><li><a href="module-BusquedaMuseosFecha.html">BusquedaMuseosFecha</a></li><li><a href="module-BusquedaMuseosPDF.html">BusquedaMuseosPDF</a></li><li><a href="module-BusquedaSalas.html">BusquedaSalas</a></li><li><a href="module-EditarMuseo.html">EditarMuseo</a></li><li><a href="module-EditarSala.html">EditarSala</a></li><li><a href="module-Footer.html">Footer</a></li><li><a href="module-GraficaMuseos.html">GraficaMuseos</a></li><li><a href="module-Inicio.html">Inicio</a></li><li><a href="module-LandingPage.html">LandingPage</a></li><li><a href="module-ListadoMuseos.html">ListadoMuseos</a></li><li><a href="module-ListadoSalas.html">ListadoSalas</a></li><li><a href="module-Navbar.html">Navbar</a></li></ul><h3>Global</h3><ul><li><a href="global.html#api">api</a></li><li><a href="global.html#generatePDF">generatePDF</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sat Feb 07 2026 12:47:04 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
